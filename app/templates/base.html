{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}SkillsSpire - –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}</title>

  <meta property="og:title" content="{% block og_title %}SkillsSpire - –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}">
  <meta property="og:description" content="{% block og_description %}–û—Å–≤–æ–π—Ç–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Å –ª—É—á—à–∏–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.{% endblock %}">
  <meta property="og:image" content="{% block og_image %}{% static 'img/og-default.jpg' %}{% endblock %}">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  <meta property="og:type" content="website">

  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/favicon/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'img/favicon/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'img/favicon/favicon-16x16.png' %}">
  <link rel="manifest" href="{% static 'img/favicon/site.webmanifest' %}">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  
  <!-- AI Widget CSS -->
  <link rel="stylesheet" href="{% static 'ai-widget/ai-widget.css' %}">
  
  <style>
    #ai-bubble{ z-index:1300; }
    .mskt{ bottom:88px; }
    @media (max-width:480px){ .mskt{ bottom:100px; } }
    
    /* –ê–Ω–∏–º–∞—Ü–∏—è –º–∞—Ö–∞–Ω–∏—è –¥–ª—è –º–∞—Å–∫–æ—Ç–∞ */
    @keyframes mskt-wave {
      0%, 100% { transform: rotate(0deg) scale(1); }
      25% { transform: rotate(-5deg) scale(1.05); }
      50% { transform: rotate(5deg) scale(1.05); }
      75% { transform: rotate(-3deg) scale(1.03); }
    }

    /* üîπ –§–∏–∫—Å –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞ */
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.5rem; /* —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ª–æ–≥–æ—Ç–∏–ø–æ–º –∏ —Ç–µ–∫—Å—Ç–æ–º */
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--color-text, #000);
      text-decoration: none;
    }

    .nav-brand img {
      display: block;
      height: 40px;
      width: auto;
    }

    .nav-brand span {
      white-space: nowrap;
    }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body>

{% include "components/mascot_snowleopard.html" %}

<nav class="main-nav">
  <div class="container nav-container">
    <a class="nav-brand" href="{% url 'home' %}">
      <img src="{% static 'img/logo_skillsspire_light.png' %}" alt="SkillsSpire" width="40" height="40">
    </a>
    <button class="nav-toggle" id="navToggle" aria-label="Toggle menu">
      <span></span><span></span><span></span>
    </button>

    <div class="nav-menu" id="navMenu">
      <div class="nav-menu-inner">
        <ul class="nav-list">
          <li><a class="nav-link" href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a class="nav-link" href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a class="nav-link" href="{% url 'articles_list' %}">–°—Ç–∞—Ç—å–∏</a></li>
          <li><a class="nav-link" href="{% url 'materials_list' %}">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
          <li><a class="nav-link" href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a class="nav-link" href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
          {% if user.is_authenticated and user.is_instructor %}
          <li class="nav-highlight"><a class="nav-link" href="{% url 'course_create' %}"><i class="bi bi-plus-circle"></i> –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</a></li>
          {% endif %}
        </ul>

        <div class="nav-actions">
          <form class="nav-search" action="{% url 'courses_list' %}" method="get">
            <input type="search" name="q" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤...">
            <button type="submit" aria-label="Search"><i class="bi bi-search"></i></button>
          </form>

          {% if user.is_authenticated %}
          <div class="nav-notifications">
            <button class="nav-icon-btn is-disabled"
                    type="button"
                    title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è"
                    aria-disabled="true"
                    disabled>
              <i class="bi bi-bell"></i>
            </button>
          </div>

          <div class="nav-user dropdown">
            <button class="nav-user-btn" aria-haspopup="true" aria-expanded="false">
              {% if user.is_instructor and user.instructor_profile.avatar %}
                <img src="{{ user.instructor_profile.avatar.url }}" alt="{{ user.get_full_name }}" width="32" height="32" style="border-radius:50%;object-fit:cover;">
              {% else %}
                <div class="nav-user-avatar">{{ user.first_name|first|default:user.email|first|upper }}</div>
              {% endif %}
              <span>{{ user.first_name|default:user.email }}</span>
              <i class="bi bi-chevron-down"></i>
            </button>
            <div class="dropdown-menu">
              <h6>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</h6>
              <a href="{% url 'dashboard' %}"><i class="bi bi-speedometer2"></i> –î–∞—à–±–æ—Ä–¥</a>
              <a href="{% url 'my_courses' %}"><i class="bi bi-book"></i> –ú–æ–∏ –∫—É—Ä—Å—ã</a>
              <div class="dropdown-divider"></div>
              <a href="#"><i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
              <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button type="submit"><i class="bi bi-box-arrow-right"></i> –í—ã–π—Ç–∏</button>
              </form>
            </div>
          </div>
          {% else %}
          <div class="nav-auth">
            <a href="{% url 'signup' %}" class="btn btn-outline">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            <a href="{% url 'login' %}" class="btn btn-primary">–í–æ–π—Ç–∏</a>
          </div>
          {% endif %}

          <div class="nav-utils">
            <form action="{% url 'set_language' %}" method="post">{% csrf_token %}
              {% get_current_language as LANGUAGE_CODE %}
              <input type="hidden" name="next" value="{{ request.path }}">
              <select name="language" onchange="this.form.submit()" aria-label="Language">
                <option value="ru" {% if LANGUAGE_CODE == 'ru' %}selected{% endif %}>RU</option>
                <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>EN</option>
                <option value="kz" {% if LANGUAGE_CODE == 'kz' %}selected{% endif %}>KZ</option>
              </select>
            </form>
            <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">üåô</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

{% if messages %}
<div class="messages-container">
  <div class="container">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      <div class="alert-content">
        {% if message.tags == 'success' %}<i class="bi bi-check-circle-fill"></i>
        {% elif message.tags == 'error' %}<i class="bi bi-exclamation-circle-fill"></i>
        {% elif message.tags == 'warning' %}<i class="bi bi-exclamation-triangle-fill"></i>
        {% else %}<i class="bi bi-info-circle-fill"></i>{% endif %}
        <span>{{ message }}</span>
      </div>
      <button class="alert-close" aria-label="Close">&times;</button>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<main>
  {% block content %}{% endblock %}
</main>

<footer class="main-footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-col">
        <a class="footer-brand" href="{% url 'home' %}">
          <img src="{% static 'img/logo_skillsspire_light.png' %}" alt="SkillsSpire">
        </a>
        <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–æ–±—É—á–µ–Ω–∏—è —Å –ª—É—á—à–∏–º–∏ –∫—É—Ä—Å–∞–º–∏ –æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ —Ä—ã–Ω–∫–∞.</p>
        <div class="footer-social">
          <a href="#"><i class="bi bi-telegram"></i></a>
          <a href="#"><i class="bi bi-whatsapp"></i></a>
          <a href="#"><i class="bi bi-youtube"></i></a>
          <a href="#"><i class="bi bi-instagram"></i></a>
        </div>
      </div>

      <div class="footer-col">
        <h5>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h5>
        <ul>
          <li><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a href="{% url 'articles_list' %}">–°—Ç–∞—Ç—å–∏</a></li>
          <li><a href="{% url 'materials_list' %}">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
          <li><a href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h5>
        <ul>
          <li><a href="#">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
          <li><a href="#">–î–∏–∑–∞–π–Ω</a></li>
          <li><a href="#">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</a></li>
          <li><a href="#">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É</h5>
        <p>–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –æ –∫—É—Ä—Å–∞—Ö.</p>
        <form class="footer-subscribe">
          <input type="email" placeholder="–í–∞—à email">
          <button type="submit">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
        </form>
      </div>
    </div>

  <div class="footer-bottom">
    <div class="footer-info">
      <p>–¢–û–û ¬´SkillsSpire¬ª ‚Äî 240440040785, –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω, –≥. –ê—Å—Ç–∞–Ω–∞</p>
      <p>E-mail: <a href="mailto:support@skillsspire.com">support@skillsspire.com</a> | –¢–µ–ª: <a href="tel:+77012925568">+7 (701) 292-55-68</a></p>
    </div>
    <p>&copy; 2025 SkillsSpire. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    <div class="footer-payments">
      <img src="{% static 'img/payments/visa.png' %}" alt="Visa">
      <img src="{% static 'img/payments/mastercard.png' %}" alt="MasterCard">
    </div>
  </div>
</footer>

<!-- AI Widget HTML -->
<div id="ai-bubble" class="ai-floating" title="–ò–ò –ø–æ–º–æ—â–Ω–∏–∫ SkillsSpire"></div>
<div id="ai-panel">
  <div id="ai-header">
    <span>ü§ñ –ò–ò –ø–æ–º–æ—â–Ω–∏–∫ SkillsSpire</span>
    <button id="ai-close">‚úï</button>
  </div>
  <div id="ai-messages">
    <div class="ai-msg ai-bot">
      –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∫—É—Ä—Å–∞–º SkillsSpire. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å? üéì
    </div>
  </div>
  <div id="ai-status"></div>
  <div id="ai-inputbar">
    <textarea id="ai-text" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –∫—É—Ä—Å–∞—Ö..." rows="1"></textarea>
    <button id="ai-send">‚û§</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@srexi/purecounterjs/dist/purecounter_vanilla.js"></script>
<script defer src="{% static 'js/main.js' %}"></script>

<!-- AI Widget JS -->
<script src="{% static 'ai-widget/ai-widget.js' %}"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–∞—Å–∫–æ—Ç–∞ —Å –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫–æ–º
  const mskt = document.querySelector('.mskt');
  const msktImage = document.querySelector('.mskt-image');
  const aiBubble = document.getElementById('ai-bubble');
  
  if (msktImage && aiBubble) {
    // –ö–ª–∏–∫ –ø–æ –º–∞—Å–∫–æ—Ç—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫
    msktImage.addEventListener('click', function() {
      if (window.aiAssistant) {
        window.aiAssistant.togglePanel();
      } else {
        const bubble = document.querySelector('.mskt-bubble');
        if (bubble) {
          bubble.textContent = '–û—Ç–∫—Ä—ã–≤–∞—é –ø–æ–º–æ—â–Ω–∏–∫–∞...';
          setTimeout(() => {
            aiBubble.click();
            bubble.textContent = '–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?';
          }, 500);
        }
      }
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è "–º–∞—Ö–∞–Ω–∏—è"
    msktImage.addEventListener('mouseenter', function() {
      this.style.animation = 'mskt-wave 0.5s ease-in-out';
    });
    
    msktImage.addEventListener('animationend', function() {
      this.style.animation = 'mskt-idle 3.6s ease-in-out infinite';
    });
  }
  
  if (aiBubble) {
    aiBubble.addEventListener('click', function() {
      if (msktImage) {
        msktImage.style.animation = 'mskt-wave 0.5s ease-in-out';
      }
    });
  }
});
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
