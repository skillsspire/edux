{% load static %}
{% load tz %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}SkillsSpire ‚Äî –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}</title>

  <meta property="og:title" content="{% block og_title %}SkillsSpire ‚Äî –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}">
  <meta property="og:description" content="{% block og_description %}–£—á–∏—Ç–µ—Å—å —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π —Å PhD. –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–Ω–∞–Ω–∏—è.{% endblock %}">
  <meta property="og:image" content="{% block og_image %}{% static 'img/og-default.jpg' %}{% endblock %}">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  <meta property="og:type" content="website">

  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/favicon/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'img/favicon/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'img/favicon/favicon-16x16.png' %}">
  <link rel="manifest" href="{% static 'img/favicon/site.webmanifest' %}">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="{% static 'css/main.css' %}?v={{ now|date:'U' }}">

  <!-- AI Widget CSS -->
  <link rel="stylesheet" href="{% static 'ai-widget/ai-widget.css' %}">

  <style>
    #ai-bubble { z-index: 1300; }
    .mskt { bottom: 88px; }
    @media (max-width:480px){ .mskt { bottom: 100px; } }

    /* Premium academic minimalism */
    .nav-brand {
      display: flex; 
      align-items: center;
      gap: .5rem;
      font-size: 1.25rem;
      font-weight: 700;
      white-space: nowrap;
    }
    .nav-brand img {
      height: 40px;
      width: auto;
    }
  </style>

  {% block extra_css %}{% endblock %}
</head>
<body>

{% include "components/mascot_snowleopard.html" %}

<!-- ===============================
           NAVIGATION (Coursera style)
================================ -->
<nav class="main-nav">
  <div class="container nav-container">

    <!-- LOGO -->
    <a class="nav-brand" href="{% url 'home' %}">
      <img src="{% static 'img/logo_skillsspire_light.png' %}" alt="SkillsSpire" />
      <span>SkillsSpire</span>
    </a>

    <button class="nav-toggle" id="navToggle"><span></span><span></span><span></span></button>

    <div class="nav-menu" id="navMenu">
      <div class="nav-menu-inner">

        <!-- MAIN NAVIGATION -->
        <ul class="nav-list">
          <li><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a href="{% url 'articles_list' %}">–°—Ç–∞—Ç—å–∏</a></li>
          <li><a href="{% url 'materials_list' %}">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
          <li><a href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>

          {% if user.is_authenticated and user.is_instructor %}
          <li class="nav-highlight">
            <a href="{% url 'course_create' %}"><i class="bi bi-plus-circle"></i> –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</a>
          </li>
          {% endif %}
        </ul>

        <!-- RIGHT SIDE: SEARCH + PROFILE -->
        <div class="nav-actions">

          <!-- SEARCH -->
          <form class="nav-search" method="get" action="{% url 'courses_list' %}">
            <input type="search" name="q" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤...">
            <button type="submit"><i class="bi bi-search"></i></button>
          </form>

          {% if user.is_authenticated %}

          <!-- NO NOTIFICATIONS YET -->
          <button class="nav-icon-btn is-disabled" disabled title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è">
            <i class="bi bi-bell"></i>
          </button>

          <!-- USER PROFILE -->
          <div class="nav-user dropdown">
            <button class="nav-user-btn">
              {% if user.is_instructor and user.instructor_profile.avatar %}
                <img src="{{ user.instructor_profile.avatar.url }}" width="32" height="32" style="border-radius:50%;">
              {% else %}
                <div class="nav-user-avatar">{{ user.first_name|first|default:user.email|first|upper }}</div>
              {% endif %}
              <span>{{ user.first_name|default:user.email }}</span>
              <i class="bi bi-chevron-down"></i>
            </button>

            <div class="dropdown-menu">
              <h6>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</h6>
              <a href="{% url 'dashboard' %}"><i class="bi bi-speedometer2"></i> –î–∞—à–±–æ—Ä–¥</a>
              <a href="{% url 'my_courses' %}"><i class="bi bi-book"></i> –ú–æ–∏ –∫—É—Ä—Å—ã</a>

              <div class="dropdown-divider"></div>

              <!-- REMOVE "SETTINGS" ‚úî -->
              <!-- <a><i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a> ‚Äî —É–¥–∞–ª–µ–Ω–æ -->

              <form action="{% url 'logout' %}" method="post">{% csrf_token %}
                <button type="submit"><i class="bi bi-box-arrow-right"></i> –í—ã–π—Ç–∏</button>
              </form>
            </div>
          </div>

          {% else %}
          <div class="nav-auth">
            <a href="{% url 'signup' %}" class="btn btn-outline">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            <a href="{% url 'login' %}" class="btn btn-primary">–í–æ–π—Ç–∏</a>
          </div>
          {% endif %}

          <!-- LANGUAGE + THEME -->
          <div class="nav-utils">
            <form method="post" action="{% url 'set_language' %}">{% csrf_token %}
              {% get_current_language as LANGUAGE_CODE %}
              <input type="hidden" name="next" value="{{ request.path }}">
              <select name="language" onchange="this.form.submit()">
                <option value="ru" {% if LANGUAGE_CODE == 'ru' %}selected{% endif %}>RU</option>
                <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>EN</option>
                <option value="kz" {% if LANGUAGE_CODE == 'kz' %}selected{% endif %}>KZ</option>
              </select>
            </form>
            <button id="themeToggle" class="theme-toggle">üåô</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</nav>

<!-- MESSAGES -->
{% if messages %}
<div class="messages-container">
  <div class="container">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      <div class="alert-content">
        {% if message.tags == 'success' %}<i class="bi bi-check-circle-fill"></i>
        {% elif message.tags == 'error' %}<i class="bi bi-exclamation-circle-fill"></i>
        {% elif message.tags == 'warning' %}<i class="bi bi-exclamation-triangle-fill"></i>
        {% else %}<i class="bi bi-info-circle-fill"></i>{% endif %}
        <span>{{ message }}</span>
      </div>
      <button class="alert-close">&times;</button>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<main>
  {% block content %}{% endblock %}
</main>

<!-- FOOTER -->
<footer class="main-footer">
  <div class="container">
    <div class="footer-grid">

      <div class="footer-col">
        <a class="footer-brand" href="{% url 'home' %}">
          <img src="{% static 'img/logo_skillsspire_light.png' %}" alt="SkillsSpire">
        </a>
        <p>–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–Ω–ª–∞–π–Ω-–æ–±—É—á–µ–Ω–∏—è.</p>
      </div>

      <div class="footer-col">
        <h5>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h5>
        <ul>
          <li><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a href="{% url 'articles_list' %}">–°—Ç–∞—Ç—å–∏</a></li>
          <li><a href="{% url 'materials_list' %}">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
          <li><a href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h5>
        <ul>
          <li><a href="#">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
          <li><a href="#">–î–∏–∑–∞–π–Ω</a></li>
          <li><a href="#">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</a></li>
          <li><a href="#">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ü–æ–¥–ø–∏—Å–∫–∞</h5>
        <form class="footer-subscribe">
          <input type="email" placeholder="–í–∞—à email">
          <button type="submit">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
        </form>
      </div>
    </div>

    <div class="footer-bottom">
      <p>¬© 2025 SkillsSpire. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
  </div>
</footer>

<!-- AI Widget HTML -->
<div id="ai-bubble" class="ai-floating"></div>
<div id="ai-panel">
  <div id="ai-header">
    <span>ü§ñ –ò–ò –ø–æ–º–æ—â–Ω–∏–∫</span>
    <button id="ai-close">‚úï</button>
  </div>
  <div id="ai-messages">
    <div class="ai-msg ai-bot">–ü—Ä–∏–≤–µ—Ç! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å? üéì</div>
  </div>
  <div id="ai-inputbar">
    <textarea id="ai-text" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å..." rows="1"></textarea>
    <button id="ai-send">‚û§</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@srexi/purecounterjs/dist/purecounter_vanilla.js"></script>
<script src="{% static 'js/main.js' %}" defer></script>
<script src="{% static 'ai-widget/ai-widget.js' %}"></script>

{% block extra_js %}{% endblock %}
</body>
</html>
