{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}SkillsSpire - –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}</title>

  <meta property="og:title" content="{% block og_title %}SkillsSpire - –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã{% endblock %}">
  <meta property="og:description" content="{% block og_description %}–û—Å–≤–æ–π—Ç–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —Å –ª—É—á—à–∏–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.{% endblock %}">
  <meta property="og:image" content="{% block og_image %}{% static 'img/og-default.jpg' %}{% endblock %}">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  <meta property="og:type" content="website">

  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/favicon/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'img/favicon/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'img/favicon/favicon-16x16.png' %}">
  <link rel="manifest" href="{% static 'img/favicon/site.webmanifest' %}">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <style>
    #ai-bubble{ z-index:1300; }
    .mskt{ bottom:88px; }
    @media (max-width:480px){ .mskt{ bottom:100px; } }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body>

{% include "components/mascot_snowleopard.html" %}

<nav class="main-nav">
  <div class="container nav-container">
    <a class="nav-brand" href="{% url 'home' %}">
      <img src="{% static 'img/logo_skillsspire.png' %}" alt="SkillsSpire" width="40" height="40">
      <span>SkillsSpire</span>
    </a>

    <button class="nav-toggle" id="navToggle" aria-label="Toggle menu">
      <span></span><span></span><span></span>
    </button>

    <div class="nav-menu" id="navMenu">
      <div class="nav-menu-inner">
        <ul class="nav-list">
          <li><a class="nav-link" href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a class="nav-link" href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a class="nav-link" href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a class="nav-link" href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
          {% if user.is_authenticated and user.is_instructor %}
          <li class="nav-highlight"><a class="nav-link" href="{% url 'course_create' %}"><i class="bi bi-plus-circle"></i> –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</a></li>
          {% endif %}
        </ul>

        <div class="nav-actions">
          <form class="nav-search" action="{% url 'courses_list' %}" method="get">
            <input type="search" name="q" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤...">
            <button type="submit" aria-label="Search"><i class="bi bi-search"></i></button>
          </form>

          {% if user.is_authenticated %}
          <div class="nav-notifications">
            <button class="nav-icon-btn is-disabled"
                    type="button"
                    title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è"
                    aria-disabled="true"
                    disabled>
              <i class="bi bi-bell"></i>
            </button>
          </div>

          <div class="nav-user dropdown">
            <button class="nav-user-btn" aria-haspopup="true" aria-expanded="false">
              {% if user.is_instructor and user.instructor_profile.avatar %}
                <img src="{{ user.instructor_profile.avatar.url }}" alt="{{ user.get_full_name }}" width="32" height="32" style="border-radius:50%;object-fit:cover;">
              {% else %}
                <div class="nav-user-avatar">{{ user.first_name|first|default:user.email|first|upper }}</div>
              {% endif %}
              <span>{{ user.first_name|default:user.email }}</span>
              <i class="bi bi-chevron-down"></i>
            </button>
            <div class="dropdown-menu">
              <h6>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</h6>
              <a href="{% url 'dashboard' %}"><i class="bi bi-speedometer2"></i> –î–∞—à–±–æ—Ä–¥</a>
              <a href="{% url 'my_courses' %}"><i class="bi bi-book"></i> –ú–æ–∏ –∫—É—Ä—Å—ã</a>
              <div class="dropdown-divider"></div>
              <a href="#"><i class="bi bi-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
              <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button type="submit"><i class="bi bi-box-arrow-right"></i> –í—ã–π—Ç–∏</button>
              </form>
            </div>
          </div>
          {% else %}
          <div class="nav-auth">
            <a href="{% url 'signup' %}" class="btn btn-outline">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            <a href="{% url 'login' %}" class="btn btn-primary">–í–æ–π—Ç–∏</a>
          </div>
          {% endif %}

          <div class="nav-utils">
            <form action="{% url 'set_language' %}" method="post">{% csrf_token %}
              {% get_current_language as LANGUAGE_CODE %}
              <input type="hidden" name="next" value="{{ request.path }}">
              <select name="language" onchange="this.form.submit()" aria-label="Language">
                <option value="ru" {% if LANGUAGE_CODE == 'ru' %}selected{% endif %}>RU</option>
                <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>EN</option>
                <option value="kz" {% if LANGUAGE_CODE == 'kz' %}selected{% endif %}>KZ</option>
              </select>
            </form>
            <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">üåô</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

{% if messages %}
<div class="messages-container">
  <div class="container">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      <div class="alert-content">
        {% if message.tags == 'success' %}<i class="bi bi-check-circle-fill"></i>
        {% elif message.tags == 'error' %}<i class="bi bi-exclamation-circle-fill"></i>
        {% elif message.tags == 'warning' %}<i class="bi bi-exclamation-triangle-fill"></i>
        {% else %}<i class="bi bi-info-circle-fill"></i>{% endif %}
        <span>{{ message }}</span>
      </div>
      <button class="alert-close" aria-label="Close">&times;</button>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<main>
  {% block content %}{% endblock %}
</main>

<footer class="main-footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-col">
        <a class="footer-brand" href="{% url 'home' %}">
          <img src="{% static 'img/logo_skillsspire_light.png' %}" alt="SkillsSpire">
          <span>SkillsSpire</span>
        </a>
        <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–æ–±—É—á–µ–Ω–∏—è —Å –ª—É—á—à–∏–º–∏ –∫—É—Ä—Å–∞–º–∏ –æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ —Ä—ã–Ω–∫–∞.</p>
        <div class="footer-social">
          <a href="#"><i class="bi bi-telegram"></i></a>
          <a href="#"><i class="bi bi-whatsapp"></i></a>
          <a href="#"><i class="bi bi-youtube"></i></a>
          <a href="#"><i class="bi bi-instagram"></i></a>
        </div>
      </div>

      <div class="footer-col">
        <h5>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h5>
        <ul>
          <li><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="{% url 'courses_list' %}">–í—Å–µ –∫—É—Ä—Å—ã</a></li>
          <li><a href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
          <li><a href="{% url 'contact' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h5>
        <ul>
          <li><a href="#">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
          <li><a href="#">–î–∏–∑–∞–π–Ω</a></li>
          <li><a href="#">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</a></li>
          <li><a href="#">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h5>–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É</h5>
        <p>–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –æ –∫—É—Ä—Å–∞—Ö.</p>
        <form class="footer-subscribe">
          <input type="email" placeholder="–í–∞—à email">
          <button type="submit">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
        </form>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 SkillsSpire. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
      <div class="footer-payments">
        <img src="{% static 'img/payments/visa.png' %}" alt="Visa">
        <img src="{% static 'img/payments/mastercard.png' %}" alt="MasterCard">
        <img src="{% static 'img/payments/mir.png' %}" alt="Mir">
      </div>
    </div>
  </div>
</footer>

<link rel="stylesheet" href="{% static 'ai-widget/ai-widget.css' %}">
<div id="ai-bubble" title="–û—Ç–∫—Ä—ã—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞">–ò–ò</div>
<div id="ai-panel" role="dialog" aria-label="AI Assistant">
  <div id="ai-header">
    <span>AI-–ø–æ–º–æ—â–Ω–∏–∫</span>
    <button id="ai-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
  </div>
  <div id="ai-messages" aria-live="polite"></div>
  <div id="ai-status"></div>
  <div id="ai-inputbar">
    <textarea id="ai-text" rows="2" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å‚Ä¶"></textarea>
    <button id="ai-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>
<script>
  window.AI_WIDGET_CONFIG = { kbUrl: "{% static 'ai-widget/kb.json' %}" };
</script>
<script type="module" src="{% static 'ai-widget/ai-widget.js' %}"></script>

<script src="https://cdn.jsdelivr.net/npm/@srexi/purecounterjs/dist/purecounter_vanilla.js"></script>
<script defer src="{% static 'js/main.js' %}"></script>
{% block extra_js %}{% endblock %}
</body>
</html>