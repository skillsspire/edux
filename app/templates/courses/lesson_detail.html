{% extends "base.html" %}
{% load static %}
{% block content %}

<!-- HERO -->
<section class="course-hero modern-hero">
  <div class="container hero-inner">
    <div class="hero-left">
      <span class="course-badge">{{ course.category.name }}</span>
      <h1>{{ course.title }}</h1>
      <p>{{ course.short_description }}</p>

      <ul class="hero-features">
        <li>üéì –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</li>
        <li>üì± –û–Ω–ª–∞–π–Ω-–¥–æ—Å—Ç—É–ø 24/7</li>
        {% if course.duration_hours %}<li>‚è∞ {{ course.duration_hours }} —á–∞—Å–æ–≤</li>{% endif %}
      </ul>

      <div class="hero-actions">
        {% if has_access %}
          <a href="{% url 'lesson_detail' course.slug first_lesson.slug %}" class="btn btn-primary">–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ</a>
        {% else %}
          {% if user.is_authenticated %}
            <a href="{% url 'course_payment' course.slug %}" class="btn btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å</a>
          {% else %}
            <a href="{% url 'register' %}?next={% url 'course_payment' course.slug %}" class="btn btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å</a>
          {% endif %}
        {% endif %}
        <a href="#program" class="btn btn-outline">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞</a>
      </div>
    </div>

    <div class="hero-right">
      <div class="course-price-card">
        {% if course.discount_price %}
          <p class="old-price">{{ course.price }} ‚Ç∏</p>
          <p class="new-price">{{ course.discount_price }} ‚Ç∏</p>
        {% else %}
          <p class="new-price">{{ course.price|default:"–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }} ‚Ç∏</p>
        {% endif %}
        <button class="btn btn-primary btn-full">üõí –ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
        <button class="btn btn-outline btn-full mt-2">‚ô° –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
      </div>
    </div>
  </div>
</section>

<!-- –û –ö–£–†–°–ï -->
<section class="section course-about">
  <div class="container about-grid">
    <div class="about-text">
      <h2>–û –∫—É—Ä—Å–µ</h2>
      <p>{{ course.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è." }}</p>
      <ul>
        <li>üìò {{ lessons|length }} —É—Ä–æ–∫–æ–≤</li>
        <li>‚ôæÔ∏è –ë–µ—Å—Å—Ä–æ—á–Ω—ã–π –¥–æ—Å—Ç—É–ø</li>
        <li>üéì –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏</li>
      </ul>
    </div>
    <div class="about-img">
      <img src="{{ course.image.url|default:static('img/default.jpg') }}" alt="{{ course.title }}">
    </div>
  </div>
</section>

<!-- –ü–†–û–ì–†–ê–ú–ú–ê -->
<section id="program" class="section program-section">
  <div class="container">
    <h2 class="text-center mb-3">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞</h2>
    {% if lessons %}
      <div class="lessons-list">
        {% for lesson in lessons %}
          <div class="lesson-item">
            <div class="lesson-info">
              <h3>{{ lesson.title }}</h3>
              <p>{{ lesson.description|truncatewords:20 }}</p>
            </div>
            {% if has_access %}
              <a href="{% url 'lesson_detail' course.slug lesson.slug %}" class="btn btn-outline">‚ñ∂ –°–º–æ—Ç—Ä–µ—Ç—å</a>
            {% else %}
              <button class="btn btn-outline" disabled>üîí –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ</button>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-center text-muted">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ—è–≤–∏—Ç—Å—è —Å–∫–æ—Ä–æ.</p>
    {% endif %}
  </div>
</section>

<!-- –ò–ù–°–¢–†–£–ö–¢–û–† -->
<section class="section instructor-section">
  <div class="container text-center">
    <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</h2>
    {% if teacher_profile %}
      <div class="instructor-card">
        <img src="{{ teacher_profile.display_avatar_url|default:static('img/default.jpg') }}" alt="–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä">
        <h3>{{ teacher_profile.user.get_full_name }}</h3>
        <p class="text-secondary">{{ teacher_profile.title|default:"–≠–∫—Å–ø–µ—Ä—Ç" }}</p>
        <p>{{ teacher_profile.bio|truncatewords:30 }}</p>
      </div>
    {% else %}
      <p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ—è–≤–∏—Ç—Å—è –ø–æ–∑–∂–µ.</p>
    {% endif %}
  </div>
</section>

<!-- –û–¢–ó–´–í–´ -->
<section class="testimonials-section">
  <div class="container">
    <h2 class="text-center mb-3">–û—Ç–∑—ã–≤—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>
    {% if reviews %}
      <div class="testimonials-grid">
        {% for review in reviews %}
        <div class="testimonial-card">
          <p>‚Äú{{ review.text|truncatewords:35 }}‚Äù</p>
          <p class="text-sm text-secondary">‚Äî {{ review.user.get_full_name|default:"–ê–Ω–æ–Ω–∏–º" }}, {{ review.created_at|date:"d M Y" }}</p>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-center text-muted">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    {% endif %}
  </div>
</section>

{% endblock %}
