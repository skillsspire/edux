{% extends 'base.html' %}
{% load static humanize %}

{% block title %}{{ course.title }} ‚Äî SkillsSpire{% endblock %}

{% block content %}
{% if course %}
<section class="course-hero text-white">
  <div class="container py-5">
    <span class="badge bg-light text-dark mb-3">{{ course.category.name }}</span>

    <h1 class="fw-bold mb-3">{{ course.title }}</h1>

    <p class="lead text-white-50 mb-4">
      {{ course.short_description }}
    </p>

    <ul class="list-inline mb-4 text-white-50">
      <li class="list-inline-item me-4"><i class="bi bi-award"></i> –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</li>
      <li class="list-inline-item"><i class="bi bi-phone"></i> –î–æ—Å—Ç—É–ø 24/7</li>
    </ul>

    <div class="d-flex flex-wrap gap-3">
      <button class="btn btn-warning text-dark btn-lg" data-bs-toggle="modal" data-bs-target="#enrollModal">
        <i class="bi bi-cart me-1"></i> –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å
      </button>

      <a href="#program" class="btn btn-outline-light btn-lg">
        <i class="bi bi-list-ul me-1"></i> –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞
      </a>
    </div>
  </div>
</section>

<section class="price-box">
  <div class="container py-4">
    <div class="card price-card shadow-sm mx-auto">
      <div class="card-body text-center">
        <div class="h3 fw-bold text-primary mb-3">
          {{ course.price|floatformat:0|intcomma }} ‚Ç∏
        </div>

        <button class="btn btn-primary w-100 mb-2" data-bs-toggle="modal" data-bs-target="#enrollModal">
          <i class="bi bi-cart me-1"></i> –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
        </button>

        <button id="wishlistBtn" class="btn btn-outline-primary w-100">
          <i class="bi bi-heart me-1"></i> –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        </button>

        <hr>
        <ul class="list-unstyled small text-muted text-start">
          <li>üìò {{ lessons|length }} —É—Ä–æ–∫–æ–≤</li>
          <li>üíæ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è</li>
          <li>‚ôæÔ∏è –ë–µ—Å—Å—Ä–æ—á–Ω—ã–π –¥–æ—Å—Ç—É–ø</li>
          <li>üì± –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</li>
          <li>üéì –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="py-5">
  <div class="container">
    <h2 class="fw-bold section-title">–û –∫—É—Ä—Å–µ</h2>
    <div class="fs-5 text-muted">{{ course.description|safe|default:"–û–ø–∏—Å–∞–Ω–∏–µ —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è." }}</div>
  </div>
</section>

<section id="program" class="py-5 bg-light">
  <div class="container">
    <h2 class="fw-bold section-title">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞</h2>

    {% if lessons %}
      <div class="list-group shadow-sm rounded-3 overflow-hidden">
        {% for lesson in lessons %}
          <div class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <h6 class="mb-1">{{ lesson.title }}</h6>
              <small class="text-muted">{{ lesson.duration_minutes|default:"" }} –º–∏–Ω</small>
            </div>
            <span class="badge bg-secondary">–î–æ—Å—Ç—É–ø–Ω–æ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏</span>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ–∑–∂–µ.</p>
    {% endif %}
  </div>
</section>

<section class="py-5">
  <div class="container">
    <h2 class="fw-bold section-title">–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</h2>

    <div class="card shadow-sm border-0 p-3 instructor-card">
      <div class="d-flex align-items-center">
        <img src="{% static 'img/avatar-placeholder.svg' %}"
             class="rounded-circle me-3"
             width="80" height="80" alt="–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä">

        <div>
          <h5 class="fw-bold mb-1">{{ teacher.get_full_name }}</h5>
          <p class="text-muted mb-1">{{ teacher_profile.specialization|default:"–≠–∫—Å–ø–µ—Ä—Ç" }}</p>
          <small class="text-muted d-block">{{ teacher_profile.bio|truncatewords:25 }}</small>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="py-5 bg-light">
  <div class="container">
    <h2 class="fw-bold section-title">–û—Ç–∑—ã–≤—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>

    {% if reviews %}
      <div class="row g-4">
        {% for review in reviews %}
          <div class="col-md-6 col-lg-4">
            <div class="card review-card shadow-sm">
              <div class="card-body">
                <p class="card-text">‚Äú{{ review.comment|truncatewords:28 }}‚Äù</p>
                <div class="small text-muted mt-3">‚Äî {{ review.name|default:"–ê–Ω–æ–Ω–∏–º" }}, {{ review.created_at|date:"d M Y" }}</div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤.</p>
    {% endif %}
  </div>
</section>

{% endif %}
{% endblock %}

{% block extra_css %}
<style>
.course-hero {
  background: linear-gradient(135deg, #0046ad, #06b6d4);
}
.section-title {
  border-left: 4px solid #0046ad;
  padding-left: 10px;
  margin-bottom: 1.5rem;
}
.price-card {
  max-width: 420px;
  border-radius: 16px;
}
.instructor-card {
  border-radius: 16px;
}
.review-card {
  border-radius: 16px;
}
</style>
{% endblock %}
