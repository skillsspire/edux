{% extends 'base.html' %}
{% load static %}

{% block title %}–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã ‚Äî SkillsSpire{% endblock %}

{% block content %}

<!-- HERO -->
<section class="courses-hero">
  <div class="container text-center">
    <h1>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã</h1>
    <p class="lead">
      –û–±—É—á–µ–Ω–∏–µ —É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π —Å PhD ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
    </p>

    <p class="subtext">
      –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ, —Ñ–∏–Ω–∞–Ω—Å–∞–º, –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ.  
      –ü–æ–ª—É—á–∏—Ç–µ –∑–Ω–∞–Ω–∏—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è —Ä–µ–∑—é–º–µ –∏–ª–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∑–∞ —Ä—É–±–µ–∂.
    </p>
  </div>
</section>

<section class="section py-5">
  <div class="container">

    <!-- –§–ò–õ–¨–¢–†–´ -->
    <div class="filters-modern shadow-sm mb-5">
      <select class="filter-select" data-param="level">
        <option value="">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
        <option value="beginner" {% if request.GET.level == 'beginner' %}selected{% endif %}>–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
        <option value="intermediate" {% if request.GET.level == 'intermediate' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
        <option value="advanced" {% if request.GET.level == 'advanced' %}selected{% endif %}>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
      </select>

      <select class="filter-select" data-param="certificate">
        <option value="">–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã</option>
        <option value="available" {% if request.GET.certificate == 'available' %}selected{% endif %}>–° —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º</option>
        <option value="not_available" {% if request.GET.certificate == 'not_available' %}selected{% endif %}>–ë–µ–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</option>
      </select>

      <select class="filter-select" data-param="sort">
        <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
        <option value="popular" {% if sort_by == 'popular' %}selected{% endif %}>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</option>
        <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</option>
      </select>
    </div>

    <!-- –°–ï–¢–ö–ê –ö–£–†–°–û–í -->
    <div class="courses-grid-modern">
      {% for course in courses %}
      <a href="{% url 'course_detail' course.course.slug %}" class="course-card-modern-link">
        <article class="course-card-modern">

          <img src="{{ course.image_url }}"
               alt="{{ course.title }}"
               class="course-card-img"
               loading="lazy">

          <div class="course-card-body">

            <div class="course-card-top">
              {% if course.type == 'profession' %}
                <span class="tag tag-blue">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è</span>
              {% else %}
                <span class="tag tag-gray">–ö—É—Ä—Å</span>
              {% endif %}

              {% if course.is_popular %}
                <span class="tag tag-hot">–•–∏—Ç</span>
              {% endif %}
            </div>

            <h3 class="course-title">{{ course.title }}</h3>

            <p class="course-desc">
              {{ course.short_description|default:course.course.description|truncatewords:22 }}
            </p>

            <div class="course-meta">
              {% if course.duration_hours %}
                <span>‚è± {{ course.duration_hours }} —á</span>
              {% endif %}
              {% if course.has_certificate %}
                <span>üéì –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</span>
              {% endif %}
            </div>

          </div>
        </article>
      </a>
      {% empty %}
      <div class="text-center py-5">
        <i class="bi bi-search" style="font-size:3rem;color:#cbd5e0;"></i>
        <h4 class="text-muted mt-3">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
        <p class="text-muted">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
        <a href="{% url 'courses_list' %}" class="btn btn-primary mt-3">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
      </div>
      {% endempty %}
    </div>

    <!-- –ü–ê–ì–ò–ù–ê–¶–ò–Ø -->
    {% if is_paginated %}
    <nav class="mt-5 pagination-modern">
      <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li><a href="?page={{ page_obj.previous_page_number }}{% for key,value in request.GET.items %}{% if key!='page' %}&{{key}}={{value}}{% endif %}{% endfor %}">–ù–∞–∑–∞–¥</a></li>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
        {% if num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li class="{% if page_obj.number == num %}active{% endif %}">
          <a href="?page={{ num }}{% for key,value in request.GET.items %}{% if key!='page' %}&{{key}}={{value}}{% endif %}{% endfor %}">{{ num }}</a>
        </li>
        {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
        <li><a href="?page={{ page_obj.next_page_number }}{% for key,value in request.GET.items %}{% if key!='page' %}&{{key}}={{value}}{% endif %}{% endfor %}">–í–ø–µ—Ä–µ–¥</a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
</section>

{% endblock %}


{% block extra_css %}
<style>

/* === HERO –ë–õ–û–ö === */
.courses-hero {
  text-align: center;
  padding: 5.5rem 0 4rem;
  background: linear-gradient(135deg,#01349D,#3b5cc5);
  color:#fff;
}

.courses-hero h1 {
  font-size: clamp(28px, 4vw, 42px);
  font-weight: 800;
  margin-bottom: .8rem;
}

.courses-hero .lead {
  font-size: 1.25rem;
  opacity: .95;
}

.courses-hero .subtext {
  margin-top: 1rem;
  max-width: 720px;
  margin-left: auto;
  margin-right: auto;
  opacity: .85;
}


/* === –§–ò–õ–¨–¢–†–´ === */
.filters-modern {
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
  padding: 1rem 1.5rem;
  background: #fff;
  border-radius: 14px;
  border: 1px solid var(--color-border);
}

.filters-modern select {
  padding: .7rem 1rem;
  border-radius: 10px;
  border: 1px solid var(--color-border);
  font-size: 1rem;
  background: var(--color-bg-white);
  cursor: pointer;
  transition: .2s;
}

.filters-modern select:hover {
  border-color: var(--color-primary);
}


/* === –°–ï–¢–ö–ê –ö–£–†–°–û–í === */
.courses-grid-modern {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(300px,1fr));
  gap: 1.8rem;
}

.course-card-modern-link {
  text-decoration: none;
  color: inherit;
  display: block;
}

.course-card-modern {
  background: #fff;
  border-radius: 16px;
  box-shadow: var(--shadow-sm);
  border: 1px solid #e5e7eb;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: .25s ease;
}

.course-card-modern:hover {
  transform: translateY(-6px);
  box-shadow: var(--shadow-md);
}

.course-card-img {
  height: 190px;
  object-fit: cover;
  width: 100%;
}

.course-card-body {
  padding: 1.3rem 1.4rem 1.5rem;
  display: flex;
  flex-direction: column;
  flex: 1;
}

.tag {
  font-size: .75rem;
  padding: .35rem .75rem;
  border-radius: 999px;
  font-weight: 600;
}

.tag-blue { background:#eaf1ff; color:#01349d; }
.tag-gray { background:#f1f1f3; color:#4a4a4a; }
.tag-hot { background:#fee2e2; color:#b91c1c; }

.course-card-top {
  display: flex;
  justify-content: space-between;
  margin-bottom: .8rem;
}

.course-title {
  font-size: 1.15rem;
  font-weight: 700;
  margin-bottom: .5rem;
}

.course-desc {
  flex: 1;
  color: var(--color-text-secondary);
  font-size: 0.95rem;
  line-height: 1.45;
}

.course-meta {
  margin-top: 1rem;
  display: flex;
  gap: 1rem;
  font-size: .9rem;
  color: var(--color-text-tertiary);
}


/* === –ü–ê–ì–ò–ù–ê–¶–ò–Ø === */
.pagination-modern ul {
  gap: .5rem;
}

.pagination-modern a {
  padding: .55rem 1rem;
  border-radius: 10px;
  background: #fff;
  color: #01349d;
  border: 1px solid #dce0e6;
  text-decoration: none;
  transition: .2s;
}

.pagination-modern .active a {
  background: #01349d;
  color: #fff;
}

.pagination-modern a:hover {
  background: #f0f4ff;
}

</style>
{% endblock %}


{% block extra_js %}
<script>
document.querySelectorAll('.filter-select').forEach(select => {
  select.addEventListener('change', () => {
    const url = new URL(window.location);
    const param = select.dataset.param;
    const value = select.value;

    if (value) url.searchParams.set(param, value);
    else url.searchParams.delete(param);

    url.searchParams.delete('page');
    window.location.href = url.toString();
  });
});
</script>
{% endblock %}
