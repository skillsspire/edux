{% extends "base.html" %}
{% load i18n %}

{% block content %}
<section class="section">
    <div class="container">
        <h1 class="text-center mb-5">{% trans "All Courses" %}</h1>

        <!-- Фильтры -->
        <form method="get" class="row g-2 mb-5">
            <div class="col-md-3">
                <input type="text" name="q" class="form-control"
                       placeholder="{% trans 'Search courses...' %}" value="{{ request.GET.q }}">
            </div>

            <div class="col-md-2">
                <select name="category" class="form-select">
                    <option value="">{% trans "All Categories" %}</option>
                    {% for category in categories %}
                    <option value="{{ category.slug }}" {% if request.GET.category == category.slug %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-2">
                <select name="level" class="form-select">
                    <option value="">{% trans "Any Level" %}</option>
                    <option value="beginner" {% if request.GET.level == "beginner" %}selected{% endif %}>{% trans "Beginner" %}</option>
                    <option value="intermediate" {% if request.GET.level == "intermediate" %}selected{% endif %}>{% trans "Intermediate" %}</option>
                    <option value="advanced" {% if request.GET.level == "advanced" %}selected{% endif %}>{% trans "Advanced" %}</option>
                </select>
            </div>

            <div class="col-md-2">
                <select name="price" class="form-select">
                    <option value="">{% trans "All" %}</option>
                    <option value="free" {% if request.GET.price == "free" %}selected{% endif %}>{% trans "Free" %}</option>
                    <option value="paid" {% if request.GET.price == "paid" %}selected{% endif %}>{% trans "Paid" %}</option>
                </select>
            </div>

            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">{% trans "Filter" %}</button>
            </div>
        </form>

        <!-- Сетка курсов -->
        <div class="grid grid-3">
            {% for course in courses %}
            <div class="card">
                {% if course.image %}
                <img src="{{ course.image.url }}" class="card-img-top mb-3 rounded" alt="{{ course.title }}">
                {% endif %}
                <h3 class="card-title">{{ course.title }}</h3>
                <p class="card-text">{{ course.description|truncatewords:20 }}</p>
                <p class="text-muted small">
                    {% trans "Instructor:" %} {{ course.author.get_full_name|default:course.author.username }}
                </p>
                <p class="fw-bold text-primary">
                    {% if course.price == 0 %}
                        {% trans "Free" %}
                    {% else %}
                        ${{ course.price }}
                    {% endif %}
                </p>
                <a href="{% url 'course_detail' course.slug %}" class="btn btn-secondary w-100">
                    {% trans "View Details" %}
                </a>
            </div>
            {% empty %}
            <p class="text-center text-muted">{% trans "No courses available yet." %}</p>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}
