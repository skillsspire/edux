{% extends "base.html" %}
{% load static %}

{% block title %}SkillsSpire ‚Äî –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–µ –æ–Ω–ª–∞–π–Ω-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ{% endblock %}

{% block extra_css %}
<style>
.fade-up {
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.6s ease;
}
.fade-up.visible {
  opacity: 1;
  transform: translateY(0);
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
{% endblock %}

{% block content %}

<!-- === HERO === -->
<section class="course-hero text-center fade-up">
  <div class="container">
    <span class="course-badge">üéì –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–µ –æ–Ω–ª–∞–π–Ω-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</span>
    <h1 class="course-title">–ù–∞—á–Ω–∏ –æ–±—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ</h1>
    <p class="course-subtitle">
      –£—á–∏—Å—å —É –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–æ–≤, –ø–æ–ª—É—á–∞–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏ —É–ª—É—á—à–∞–π —Å–≤–æ–∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.
    </p>

    <form action="{% url 'courses_list' %}" method="get" class="hero-search">
      <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤..." aria-label="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤">
      <button type="submit">–ü–æ–∏—Å–∫</button>
    </form>

    <div class="mt-3 fade-up">
      <a href="{% url 'courses_list' %}" class="hero-btn hero-btn-primary">–ù–∞—á–Ω–∏ –æ–±—É—á–µ–Ω–∏–µ</a>
      <a href="#courses" class="hero-btn hero-btn-secondary">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫—É—Ä—Å—ã</a>
    </div>
  </div>
</section>

<!-- === –ö–£–†–°–´ === -->
<section id="courses" class="section courses-section fade-up">
  <div class="container text-center">
    <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã</h2>
    <p class="text-muted">–°–∞–º—ã–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è</p>

    <div class="courses-grid mt-4">
      {% for course in popular_courses %}
        <a href="{% url 'course_detail' course.course.slug %}" class="course-card-link fade-up">
          <div class="course-card">
            <img src="{{ course.image_url|default:'/static/img/course-placeholder.png' }}" alt="{{ course.title }}" class="course-card-img">
            <div class="course-card-content">
              <span class="course-category">{{ course.course.category.name|default:"–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ" }}</span>
              <h3 class="course-card-title">{{ course.title }}</h3>
              <p class="course-card-text">{{ course.short_description|default:course.course.description|truncatechars:120 }}</p>
              <div class="course-card-meta">
                <div class="course-rating">
                  <i class="bi bi-star-fill"></i>
                  <span>{{ course.average_rating|default:"4.9" }}</span>
                  <span class="course-reviews">({{ course.reviews_count|default:"0" }} –æ—Ç–∑—ã–≤–æ–≤)</span>
                </div>
                <div class="course-price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
              </div>
            </div>
          </div>
        </a>
      {% empty %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫—É—Ä—Å–æ–≤</p>
      {% endfor %}
    </div>

    <div class="mt-4 fade-up">
      <a href="{% url 'courses_list' %}" class="courses-btn">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫—É—Ä—Å—ã</a>
    </div>
  </div>
</section>

<!-- === –û–¢–ó–´–í–´ === -->
<section class="testimonials-section fade-up">
  <div class="container text-center">
    <h2>–û—Ç–∑—ã–≤—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>
    <p class="text-muted">–ò—Å—Ç–æ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ –Ω–∞—à–∏—Ö –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤</p>

    <div class="swiper testimonials-swiper mt-4">
      <div class="swiper-wrapper">
        {% for review in reviews %}
          <div class="swiper-slide">
            <div class="testimonial-card">
              <h4 class="mb-1">
                {% if review.user %}
                  {{ review.user.get_full_name|default:review.user.username }}
                {% elif review.name %}
                  {{ review.name }}
                {% else %}
                  –ê–Ω–æ–Ω–∏–º
                {% endif %}
              </h4>
              <p class="text-muted small mb-2"><strong>{{ review.course.title|default:"–ö—É—Ä—Å" }}</strong></p>

              <div class="stars text-warning small mb-3">
                {% for i in "12345" %}
                  <i class="bi bi-star{% if forloop.counter <= review.rating %}-fill{% else %}-half{% endif %}"></i>
                {% endfor %}
              </div>

              <blockquote class="testimonial-text">"{{ review.comment|default:"–û—Ç–ª–∏—á–Ω—ã–π –∫—É—Ä—Å, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é!" }}"</blockquote>
              <small class="text-muted">{{ review.created_at|date:"d E Y" }}</small>
            </div>
          </div>
        {% empty %}
          <div class="swiper-slide">
            <div class="testimonial-card">
              <h4>–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞</h4>
              <p class="text-muted small"><strong>–ö—É—Ä—Å –ø–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ</strong></p>
              <div class="stars text-warning small mb-3">
                <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i>
              </div>
              <blockquote class="testimonial-text">"–û—Ç–ª–∏—á–Ω—ã–π –∫—É—Ä—Å! –ú–Ω–æ–≥–æ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –ø—Ä–∏–º–µ—Ä–æ–≤."</blockquote>
              <small class="text-muted">–ò—é–Ω—å 2024</small>
            </div>
          </div>
        {% endfor %}
      </div>

      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </div>
</section>

<!-- === CTA === -->
<section class="cta-section fade-up">
  <div class="container text-center">
    <h2>–ù–∞—á–Ω–∏ –æ–±—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ</h2>
    <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ —Ç—ã—Å—è—á–∞–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —É—á–∞—Ç—Å—è —Å –Ω–∞–º–∏!</p>
    <a href="{% url 'courses_list' %}" class="cta-button">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫—É—Ä—Å—ã</a>
  </div>
</section>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.classList.add("visible");
    });
  }, { threshold: 0.1 });
  document.querySelectorAll(".fade-up").forEach(el => observer.observe(el));

  // Swiper –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤
  if (document.querySelector(".testimonials-swiper")) {
    new Swiper(".testimonials-swiper", {
      slidesPerView: 1,
      spaceBetween: 20,
      loop: true,
      autoplay: { delay: 5000, disableOnInteraction: false },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      breakpoints: {
        768: { slidesPerView: 2 },
        1200: { slidesPerView: 3 }
      }
    });
  }
});
</script>
{% endblock %}
